import * as vscode from 'vscode';
import * as http from 'http';
import * as fs from 'fs';
import * as path from 'path';
import WebSocket from 'ws';
import chokidar from 'chokidar';

let server: http.Server | undefined;
let wss: WebSocket.Server | undefined;
let statusBarButton: vscode.StatusBarItem;
let watchPaused = false;



function setServerContext(isRunning: boolean) {
  vscode.commands.executeCommand('setContext', 'pinsandcurves.serverRunning', isRunning);
}

export function activate(context: vscode.ExtensionContext) {
  // Create the status bar button

  setServerContext(false);
  // Register the toggle command
  const toggleCommand = vscode.commands.registerCommand('pinsandcurves.toggleServer', async () => {
    if (server) {
      stopWebServer();
      setServerContext(false);
    } else {
      startWebServer(context);
      setServerContext(true);
    }
  });
  context.subscriptions.push(toggleCommand);

  const createProjectCommand = vscode.commands.registerCommand('pinsandcurves.createProject', async () => {
    const workspaceFolders = vscode.workspace.workspaceFolders;
    if (!workspaceFolders) {
      vscode.window.showErrorMessage('No workspace folder is open.');
      return;
    }
    const workspacePath = workspaceFolders[0].uri.fsPath;
    const xmlFilePath = path.join(workspacePath, 'project.pinsandcurves.xml');
    const jsonFilePath = path.join(workspacePath, 'project.pinsandcurves.json');
    if (fs.existsSync(jsonFilePath)) {
      vscode.window.showErrorMessage('A project file already exists in this folder.');
      return;
    }
    const defaultXMLFile = `
<pins-and-curves>
  <constant key="projectName" value="example project"/>
  <constant key="sceneWidth" value="1920"/>
  <constant key="sceneHeight" value="1080"/>
  <extensions>
    <extension src="https://storage.googleapis.com/pinsandcurvesservice/defaultExtensions/index.js"/>
  </extensions>
  <scene>
    <background color="purple" id="dvd"/>
    <svg width="1920" height="1080" viewBox="0 0 1920 1080" id="svg" preserveAspectRatio="xMidYMid meet">
      <circle cx="960" cy="540" r="100" fill="pink" id="u4s"/>
    </svg>
  </scene>
  
</pins-and-curves>
    `;

    const defaultJSONFile = String.raw`"{\"project\":\"{\\\"content\\\":{\\\"metaData\\\":{\\\"name\\\":\\\"example project\\\",\\\"pinsAndCurvesVersion\\\":\\\"0.0.1\\\"},\\\"orgData\\\":{\\\"signalIds\\\":[\\\"gup3zs\\\",\\\"xhxx\\\"],\\\"signalIdByPinId\\\":{\\\"7ttne\\\":\\\"gup3zs\\\",\\\"q4new5\\\":\\\"gup3zs\\\",\\\"dp17o\\\":\\\"gup3zs\\\",\\\"fi6ix4\\\":\\\"gup3zs\\\",\\\"7ajki\\\":\\\"gup3zs\\\",\\\"gvacgw\\\":\\\"gup3zs\\\",\\\"clxwd\\\":\\\"gup3zs\\\",\\\"3sixj\\\":\\\"gup3zs\\\",\\\"5iwibu\\\":\\\"gup3zs\\\",\\\"iisga\\\":\\\"gup3zs\\\",\\\"t5o2w\\\":\\\"gup3zs\\\",\\\"sga59\\\":\\\"xhxx\\\",\\\"klulgp\\\":\\\"xhxx\\\",\\\"hnccy\\\":\\\"gup3zs\\\",\\\"5t14uv\\\":\\\"gup3zs\\\"},\\\"pinIds\\\":[\\\"7ttne\\\",\\\"q4new5\\\",\\\"dp17o\\\",\\\"fi6ix4\\\",\\\"7ajki\\\",\\\"gvacgw\\\",\\\"clxwd\\\",\\\"3sixj\\\",\\\"5iwibu\\\",\\\"iisga\\\",\\\"t5o2w\\\",\\\"sga59\\\",\\\"klulgp\\\",\\\"hnccy\\\",\\\"5t14uv\\\"],\\\"signalNames\\\":{\\\"gup3zs\\\":\\\"Signal 1\\\",\\\"xhxx\\\":\\\"Signal 2\\\"},\\\"signalTypes\\\":{\\\"gup3zs\\\":\\\"continuous\\\",\\\"xhxx\\\":\\\"continuous\\\"},\\\"activeSignalIds\\\":[\\\"gup3zs\\\",\\\"xhxx\\\"]},\\\"timelineData\\\":{\\\"numberOfFrames\\\":250,\\\"framesPerSecond\\\":30,\\\"playheadPosition\\\":90,\\\"focusRange\\\":[60,150],\\\"playing\\\":false},\\\"signalData\\\":{\\\"gup3zs\\\":{\\\"id\\\":\\\"gup3zs\\\",\\\"type\\\":\\\"continuous\\\",\\\"range\\\":[0,1],\\\"defaultValue\\\":0,\\\"defaultCurve\\\":\\\"return easyParabola();\\\",\\\"pinIds\\\":[\\\"7ttne\\\",\\\"q4new5\\\",\\\"dp17o\\\",\\\"fi6ix4\\\",\\\"7ajki\\\",\\\"gvacgw\\\",\\\"clxwd\\\",\\\"3sixj\\\",\\\"5iwibu\\\",\\\"iisga\\\",\\\"t5o2w\\\",\\\"hnccy\\\",\\\"5t14uv\\\"],\\\"pinTimes\\\":{\\\"7ttne\\\":41,\\\"q4new5\\\":60,\\\"dp17o\\\":79,\\\"fi6ix4\\\":89,\\\"7ajki\\\":99,\\\"gvacgw\\\":106,\\\"clxwd\\\":111,\\\"3sixj\\\":116,\\\"5iwibu\\\":120,\\\"iisga\\\":123,\\\"t5o2w\\\":126,\\\"hnccy\\\":128,\\\"5t14uv\\\":130},\\\"pinValues\\\":{\\\"7ttne\\\":0,\\\"q4new5\\\":0.9542050883235196,\\\"dp17o\\\":0,\\\"fi6ix4\\\":0.4792356404843907,\\\"7ajki\\\":0.001422064215087254,\\\"gvacgw\\\":0.2716142650816577,\\\"clxwd\\\":0.001422064215087254,\\\"3sixj\\\":0.13794022886345986,\\\"5iwibu\\\":0,\\\"iisga\\\":0.06683701810909905,\\\"t5o2w\\\":0,\\\"hnccy\\\":0.031171867389680773,\\\"5t14uv\\\":0},\\\"curves\\\":{\\\"7ttne\\\":\\\"return easyParabola();\\\",\\\"q4new5\\\":\\\"return easyParabola();\\\",\\\"dp17o\\\":\\\"return easyParabola();\\\",\\\"fi6ix4\\\":\\\"return easyParabola();\\\",\\\"7ajki\\\":\\\"return easyParabola();\\\",\\\"gvacgw\\\":\\\"return easyParabola();\\\",\\\"clxwd\\\":\\\"return easyParabola();\\\",\\\"3sixj\\\":\\\"return easyParabola();\\\",\\\"5iwibu\\\":\\\"return easyParabola();\\\",\\\"iisga\\\":\\\"return easyParabola();\\\",\\\"t5o2w\\\":\\\"return easyParabola();\\\",\\\"hnccy\\\":\\\"return easyParabola();\\\",\\\"5t14uv\\\":\\\"return easyParabola();\\\"}},\\\"xhxx\\\":{\\\"id\\\":\\\"xhxx\\\",\\\"type\\\":\\\"continuous\\\",\\\"range\\\":[0,1],\\\"defaultValue\\\":0,\\\"defaultCurve\\\":\\\"return fitSignal(\\\\\\\"Signal 1\\\\\\\", previousPinValue, nextPinValue);\\\",\\\"pinIds\\\":[\\\"sga59\\\",\\\"klulgp\\\"],\\\"pinTimes\\\":{\\\"sga59\\\":58,\\\"klulgp\\\":152},\\\"pinValues\\\":{\\\"sga59\\\":0.5945718924706238,\\\"klulgp\\\":0.17367220226805172},\\\"curves\\\":{\\\"sga59\\\":\\\"return fitSignal(\\\\\\\"Signal 1\\\\\\\", previousPinValue, nextPinValue);\\\",\\\"klulgp\\\":\\\"return fitSignal(\\\\\\\"Signal 1\\\\\\\", previousPinValue, nextPinValue);\\\"}}},\\\"templateData\\\":{}},\\\"__internal\\\":{\\\"namedStates\\\":{\\\"commit\\\":\\\"stateLYdiYkGNZL\\\"},\\\"states\\\":{\\\"initial\\\":{\\\"forward\\\":[],\\\"backward\\\":[],\\\"nextState\\\":\\\"statezyWYbMgCVn\\\"},\\\"statezyWYbMgCVn\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updateProjectName\\\",\\\"projectName\\\":\\\"example project\\\"}],\\\"backward\\\":[{\\\"type\\\":\\\"updateProjectName\\\",\\\"projectName\\\":\\\"New Project\\\"}],\\\"nextState\\\":\\\"statekmZAQoaFqi\\\",\\\"previousState\\\":\\\"initial\\\"},\\\"statekmZAQoaFqi\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":20}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":20}],\\\"previousState\\\":\\\"statezyWYbMgCVn\\\",\\\"nextState\\\":\\\"stateCiZySuLadC\\\"},\\\"stateCiZySuLadC\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"createSignal\\\",\\\"signalId\\\":\\\"q3ze9\\\",\\\"signalType\\\":\\\"continuous\\\",\\\"signalName\\\":\\\"Signal 1\\\",\\\"range\\\":[0,1],\\\"defaultValue\\\":0,\\\"defaultCurve\\\":\\\"return easyParabola();\\\"}],\\\"backward\\\":[{\\\"type\\\":\\\"deleteSignal\\\",\\\"signalId\\\":\\\"q3ze9\\\"}],\\\"previousState\\\":\\\"statekmZAQoaFqi\\\",\\\"nextState\\\":\\\"statewxgwckwOHR\\\"},\\\"statewxgwckwOHR\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":30}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":20}],\\\"nextState\\\":\\\"stateyODSyqBLUx\\\",\\\"previousState\\\":\\\"stateCiZySuLadC\\\"},\\\"stateyODSyqBLUx\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"q3ze9\\\",\\\"pinId\\\":\\\"hu9cg\\\",\\\"pinTime\\\":30,\\\"pinValue\\\":0.5526611649324245,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"hu9cg\\\"}],\\\"nextState\\\":\\\"statecNzJcSvIlu\\\",\\\"previousState\\\":\\\"statewxgwckwOHR\\\"},\\\"statecNzJcSvIlu\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":59}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":30}],\\\"nextState\\\":\\\"stateMrXdpeMOjO\\\",\\\"previousState\\\":\\\"stateyODSyqBLUx\\\"},\\\"stateMrXdpeMOjO\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"q3ze9\\\",\\\"pinId\\\":\\\"p4usq\\\",\\\"pinTime\\\":59,\\\"pinValue\\\":0.3352709006099749,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"p4usq\\\"}],\\\"nextState\\\":\\\"statekpGMIyzmgi\\\",\\\"previousState\\\":\\\"statecNzJcSvIlu\\\"},\\\"statekpGMIyzmgi\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":90}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":59}],\\\"nextState\\\":\\\"statemQSBVPUVVV\\\",\\\"previousState\\\":\\\"stateMrXdpeMOjO\\\"},\\\"statemQSBVPUVVV\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"q3ze9\\\",\\\"pinId\\\":\\\"mk731\\\",\\\"pinTime\\\":90,\\\"pinValue\\\":0.6016505202726946,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"mk731\\\"}],\\\"nextState\\\":\\\"stateKMLhukezcm\\\",\\\"previousState\\\":\\\"statekpGMIyzmgi\\\"},\\\"stateKMLhukezcm\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":102}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":90}],\\\"nextState\\\":\\\"stateIuRthjhXup\\\",\\\"previousState\\\":\\\"statemQSBVPUVVV\\\"},\\\"stateIuRthjhXup\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"q3ze9\\\",\\\"pinId\\\":\\\"kvo24f\\\",\\\"pinTime\\\":102,\\\"pinValue\\\":0.5036718095921542,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"kvo24f\\\"}],\\\"nextState\\\":\\\"stateCBQUiEjNxF\\\",\\\"previousState\\\":\\\"stateKMLhukezcm\\\"},\\\"stateCBQUiEjNxF\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":112}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":102}],\\\"nextState\\\":\\\"stateWBJsVFKuwQ\\\",\\\"previousState\\\":\\\"stateIuRthjhXup\\\"},\\\"stateWBJsVFKuwQ\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"q3ze9\\\",\\\"pinId\\\":\\\"5c5tgj\\\",\\\"pinTime\\\":112,\\\"pinValue\\\":0.6047123549814616,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"5c5tgj\\\"}],\\\"nextState\\\":\\\"stateaRsbbWwsFI\\\",\\\"previousState\\\":\\\"stateCBQUiEjNxF\\\"},\\\"stateaRsbbWwsFI\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":119}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":112}],\\\"nextState\\\":\\\"statebdJOpDmIur\\\",\\\"previousState\\\":\\\"stateWBJsVFKuwQ\\\"},\\\"statebdJOpDmIur\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"q3ze9\\\",\\\"pinId\\\":\\\"rpnxla\\\",\\\"pinTime\\\":119,\\\"pinValue\\\":0.5710321731850257,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"rpnxla\\\"}],\\\"nextState\\\":\\\"statevLwFfPTFLM\\\",\\\"previousState\\\":\\\"stateaRsbbWwsFI\\\"},\\\"statevLwFfPTFLM\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":124}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":119}],\\\"nextState\\\":\\\"stateBQqBdgnKkt\\\",\\\"previousState\\\":\\\"statebdJOpDmIur\\\"},\\\"stateBQqBdgnKkt\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"q3ze9\\\",\\\"pinId\\\":\\\"011bzn\\\",\\\"pinTime\\\":124,\\\"pinValue\\\":0.6077741896902285,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"011bzn\\\"}],\\\"nextState\\\":\\\"statezhjjPUQPph\\\",\\\"previousState\\\":\\\"statevLwFfPTFLM\\\"},\\\"statezhjjPUQPph\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":89}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":150}],\\\"nextState\\\":\\\"statekXyMgIZXsO\\\",\\\"previousState\\\":\\\"stateBQqBdgnKkt\\\"},\\\"statekXyMgIZXsO\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":32}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":89}],\\\"nextState\\\":\\\"statewKkkJvUIHF\\\",\\\"previousState\\\":\\\"statezhjjPUQPph\\\"},\\\"statewKkkJvUIHF\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":85}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":84}],\\\"nextState\\\":\\\"stateoHDfcwWJMy\\\",\\\"previousState\\\":\\\"statekXyMgIZXsO\\\"},\\\"stateoHDfcwWJMy\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"deleteSignal\\\",\\\"signalId\\\":\\\"q3ze9\\\"}],\\\"backward\\\":[{\\\"type\\\":\\\"createSignal\\\",\\\"signalId\\\":\\\"q3ze9\\\",\\\"signalType\\\":\\\"continuous\\\",\\\"signalName\\\":\\\"Signal 1\\\",\\\"range\\\":[0,1],\\\"defaultValue\\\":0,\\\"defaultCurve\\\":\\\"return easyParabola();\\\"}],\\\"nextState\\\":\\\"statehZmqPOQPho\\\",\\\"previousState\\\":\\\"statewKkkJvUIHF\\\"},\\\"statehZmqPOQPho\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"createSignal\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"signalType\\\":\\\"continuous\\\",\\\"signalName\\\":\\\"Signal 1\\\",\\\"range\\\":[0,1],\\\"defaultValue\\\":0,\\\"defaultCurve\\\":\\\"return easyParabola();\\\"}],\\\"backward\\\":[{\\\"type\\\":\\\"deleteSignal\\\",\\\"signalId\\\":\\\"gup3zs\\\"}],\\\"nextState\\\":\\\"statelxtXgVvuUS\\\",\\\"previousState\\\":\\\"stateoHDfcwWJMy\\\"},\\\"statelxtXgVvuUS\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":30}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":85}],\\\"nextState\\\":\\\"statejdBySxGePy\\\",\\\"previousState\\\":\\\"statehZmqPOQPho\\\"},\\\"statejdBySxGePy\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"pinId\\\":\\\"7ttne\\\",\\\"pinTime\\\":30,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"7ttne\\\"}],\\\"nextState\\\":\\\"statelexILbLfoo\\\",\\\"previousState\\\":\\\"statelxtXgVvuUS\\\"},\\\"statelexILbLfoo\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":60}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":30}],\\\"nextState\\\":\\\"stateLCaQyJWRWs\\\",\\\"previousState\\\":\\\"statejdBySxGePy\\\"},\\\"stateLCaQyJWRWs\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"pinId\\\":\\\"q4new5\\\",\\\"pinTime\\\":60,\\\"pinValue\\\":0.9997111432063104,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"q4new5\\\"}],\\\"nextState\\\":\\\"statezeEoBLAhwV\\\",\\\"previousState\\\":\\\"statelexILbLfoo\\\"},\\\"statezeEoBLAhwV\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":90}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":60}],\\\"nextState\\\":\\\"stateOsncYSTAUa\\\",\\\"previousState\\\":\\\"stateLCaQyJWRWs\\\"},\\\"stateOsncYSTAUa\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"pinId\\\":\\\"dp17o\\\",\\\"pinTime\\\":90,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"dp17o\\\"}],\\\"nextState\\\":\\\"statesHAXKFQQGu\\\",\\\"previousState\\\":\\\"statezeEoBLAhwV\\\"},\\\"statesHAXKFQQGu\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":104}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":90}],\\\"nextState\\\":\\\"statezNAinpyEOB\\\",\\\"previousState\\\":\\\"stateOsncYSTAUa\\\"},\\\"statezNAinpyEOB\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"pinId\\\":\\\"fi6ix4\\\",\\\"pinTime\\\":104,\\\"pinValue\\\":0.4792356404843907,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"fi6ix4\\\"}],\\\"nextState\\\":\\\"stateplhueKkKyC\\\",\\\"previousState\\\":\\\"statesHAXKFQQGu\\\"},\\\"stateplhueKkKyC\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":121}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":104}],\\\"nextState\\\":\\\"stateVeRMEkqenM\\\",\\\"previousState\\\":\\\"statezNAinpyEOB\\\"},\\\"stateVeRMEkqenM\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"pinId\\\":\\\"7ajki\\\",\\\"pinTime\\\":121,\\\"pinValue\\\":0.0014220642150873394,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"7ajki\\\"}],\\\"nextState\\\":\\\"stateqRIKfvZFCn\\\",\\\"previousState\\\":\\\"stateplhueKkKyC\\\"},\\\"stateqRIKfvZFCn\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":128}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":121}],\\\"nextState\\\":\\\"statetqLxvMYBOs\\\",\\\"previousState\\\":\\\"stateVeRMEkqenM\\\"},\\\"statetqLxvMYBOs\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"pinId\\\":\\\"gvacgw\\\",\\\"pinTime\\\":128,\\\"pinValue\\\":0.27161426508165776,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"gvacgw\\\"}],\\\"nextState\\\":\\\"statenKvoEfLUlG\\\",\\\"previousState\\\":\\\"stateqRIKfvZFCn\\\"},\\\"statenKvoEfLUlG\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":135}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":128}],\\\"nextState\\\":\\\"stateuaRUyheFPk\\\",\\\"previousState\\\":\\\"statetqLxvMYBOs\\\"},\\\"stateuaRUyheFPk\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"pinId\\\":\\\"clxwd\\\",\\\"pinTime\\\":135,\\\"pinValue\\\":0.0014220642150873394,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"clxwd\\\"}],\\\"nextState\\\":\\\"statesMOWgDYEwH\\\",\\\"previousState\\\":\\\"statenKvoEfLUlG\\\"},\\\"statesMOWgDYEwH\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":140}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":135}],\\\"nextState\\\":\\\"stateIXLYiyQLif\\\",\\\"previousState\\\":\\\"stateuaRUyheFPk\\\"},\\\"stateIXLYiyQLif\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"pinId\\\":\\\"3sixj\\\",\\\"pinTime\\\":140,\\\"pinValue\\\":0.1379402288634598,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"3sixj\\\"}],\\\"nextState\\\":\\\"stateLVJrIHoWnG\\\",\\\"previousState\\\":\\\"statesMOWgDYEwH\\\"},\\\"stateLVJrIHoWnG\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":145}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":140}],\\\"nextState\\\":\\\"stategnDGeougvi\\\",\\\"previousState\\\":\\\"stateIXLYiyQLif\\\"},\\\"stategnDGeougvi\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"pinId\\\":\\\"5iwibu\\\",\\\"pinTime\\\":145,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"5iwibu\\\"}],\\\"nextState\\\":\\\"stateBFdFdWrTPs\\\",\\\"previousState\\\":\\\"stateLVJrIHoWnG\\\"},\\\"stateBFdFdWrTPs\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":148}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":145}],\\\"nextState\\\":\\\"statekSMkRiZkvg\\\",\\\"previousState\\\":\\\"stategnDGeougvi\\\"},\\\"statekSMkRiZkvg\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":148,\\\"pinValue\\\":0.06683701810909913,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"iisga\\\"}],\\\"nextState\\\":\\\"stateBMDcjkUfoe\\\",\\\"previousState\\\":\\\"stateBFdFdWrTPs\\\"},\\\"stateBMDcjkUfoe\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":151}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":148}],\\\"nextState\\\":\\\"stateyeiKmrrxfx\\\",\\\"previousState\\\":\\\"statekSMkRiZkvg\\\"},\\\"stateyeiKmrrxfx\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":151,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"t5o2w\\\"}],\\\"nextState\\\":\\\"staterVCOtuZIEO\\\",\\\"previousState\\\":\\\"stateBMDcjkUfoe\\\"},\\\"staterVCOtuZIEO\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"q4new5\\\",\\\"pinTime\\\":60,\\\"pinValue\\\":0.9542050883235196,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"q4new5\\\",\\\"pinTime\\\":60,\\\"pinValue\\\":0.9997111432063104,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"nextState\\\":\\\"stateDeOHIyINuE\\\",\\\"previousState\\\":\\\"stateyeiKmrrxfx\\\"},\\\"stateDeOHIyINuE\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"fi6ix4\\\",\\\"pinTime\\\":106,\\\"pinValue\\\":0.4792356404843907,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"fi6ix4\\\",\\\"pinTime\\\":104,\\\"pinValue\\\":0.4792356404843907,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"nextState\\\":\\\"statePZOiCVahSO\\\",\\\"previousState\\\":\\\"staterVCOtuZIEO\\\"},\\\"statePZOiCVahSO\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":60}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":151}],\\\"nextState\\\":\\\"stateygnJZaOjyF\\\",\\\"previousState\\\":\\\"stateDeOHIyINuE\\\"},\\\"stateygnJZaOjyF\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updateFocusRange\\\",\\\"focusRange\\\":[60,100]}],\\\"backward\\\":[{\\\"type\\\":\\\"updateFocusRange\\\",\\\"focusRange\\\":[0,100]}],\\\"nextState\\\":\\\"stateYpmBQSsdUc\\\",\\\"previousState\\\":\\\"statePZOiCVahSO\\\"},\\\"stateYpmBQSsdUc\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updateFocusRange\\\",\\\"focusRange\\\":[60,150]}],\\\"backward\\\":[{\\\"type\\\":\\\"updateFocusRange\\\",\\\"focusRange\\\":[60,100]}],\\\"nextState\\\":\\\"stateQZvgAGzLdJ\\\",\\\"previousState\\\":\\\"stateygnJZaOjyF\\\"},\\\"stateQZvgAGzLdJ\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"7ajki\\\",\\\"pinTime\\\":121,\\\"pinValue\\\":0.0014220642150873139,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"gvacgw\\\",\\\"pinTime\\\":128,\\\"pinValue\\\":0.27161426508165776,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"clxwd\\\",\\\"pinTime\\\":134,\\\"pinValue\\\":0.0014220642150873139,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"3sixj\\\",\\\"pinTime\\\":139,\\\"pinValue\\\":0.13794022886345977,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"5iwibu\\\",\\\"pinTime\\\":144,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":147,\\\"pinValue\\\":0.06683701810909909,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":150,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"7ajki\\\",\\\"pinTime\\\":121,\\\"pinValue\\\":0.0014220642150873394,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"gvacgw\\\",\\\"pinTime\\\":128,\\\"pinValue\\\":0.27161426508165776,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"clxwd\\\",\\\"pinTime\\\":135,\\\"pinValue\\\":0.0014220642150873394,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"3sixj\\\",\\\"pinTime\\\":140,\\\"pinValue\\\":0.1379402288634598,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"5iwibu\\\",\\\"pinTime\\\":145,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":148,\\\"pinValue\\\":0.06683701810909913,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":151,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"nextState\\\":\\\"statekXCnUxpKlQ\\\",\\\"previousState\\\":\\\"stateYpmBQSsdUc\\\"},\\\"statekXCnUxpKlQ\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updateFocusRange\\\",\\\"focusRange\\\":[60,180]}],\\\"backward\\\":[{\\\"type\\\":\\\"updateFocusRange\\\",\\\"focusRange\\\":[60,150]}],\\\"nextState\\\":\\\"statePPKjzmWetF\\\",\\\"previousState\\\":\\\"stateQZvgAGzLdJ\\\"},\\\"statePPKjzmWetF\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"createSignal\\\",\\\"signalId\\\":\\\"xhxx\\\",\\\"signalType\\\":\\\"continuous\\\",\\\"signalName\\\":\\\"Signal 2\\\",\\\"range\\\":[0,1],\\\"defaultValue\\\":0,\\\"defaultCurve\\\":\\\"return fitSignal(\\\\\\\"Signal 1\\\\\\\", previousPinValue, nextPinValue);\\\"}],\\\"backward\\\":[{\\\"type\\\":\\\"deleteSignal\\\",\\\"signalId\\\":\\\"xhxx\\\"}],\\\"nextState\\\":\\\"stateUDllBlAxhn\\\",\\\"previousState\\\":\\\"statekXCnUxpKlQ\\\"},\\\"stateUDllBlAxhn\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":58}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":60}],\\\"nextState\\\":\\\"stateOZDnKbdIJC\\\",\\\"previousState\\\":\\\"statePPKjzmWetF\\\"},\\\"stateOZDnKbdIJC\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"xhxx\\\",\\\"pinId\\\":\\\"sga59\\\",\\\"pinTime\\\":58,\\\"pinValue\\\":0.8234105589885271,\\\"functionString\\\":\\\"return fitSignal(\\\\\\\"Signal 1\\\\\\\", previousPinValue, nextPinValue);\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"sga59\\\"}],\\\"nextState\\\":\\\"stateoKZgkECRtz\\\",\\\"previousState\\\":\\\"stateUDllBlAxhn\\\"},\\\"stateoKZgkECRtz\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":181}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":58}],\\\"nextState\\\":\\\"stateVCtdUJMEzb\\\",\\\"previousState\\\":\\\"stateOZDnKbdIJC\\\"},\\\"stateVCtdUJMEzb\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"xhxx\\\",\\\"pinId\\\":\\\"klulgp\\\",\\\"pinTime\\\":181,\\\"pinValue\\\":0.25948670221226544,\\\"functionString\\\":\\\"return fitSignal(\\\\\\\"Signal 1\\\\\\\", previousPinValue, nextPinValue);\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"klulgp\\\"}],\\\"nextState\\\":\\\"stateLnXuGgPLjT\\\",\\\"previousState\\\":\\\"stateoKZgkECRtz\\\"},\\\"stateLnXuGgPLjT\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":91}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":90}],\\\"nextState\\\":\\\"stateLDPQaqfjSp\\\",\\\"previousState\\\":\\\"stateVCtdUJMEzb\\\"},\\\"stateLDPQaqfjSp\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"sga59\\\",\\\"pinTime\\\":58,\\\"pinValue\\\":0.5945718924706238,\\\"functionString\\\":\\\"return fitSignal(\\\\\\\"Signal 1\\\\\\\", previousPinValue, nextPinValue);\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"sga59\\\",\\\"pinTime\\\":58,\\\"pinValue\\\":0.8234105589885271,\\\"functionString\\\":\\\"return fitSignal(\\\\\\\"Signal 1\\\\\\\", previousPinValue, nextPinValue);\\\"}]}],\\\"nextState\\\":\\\"stateNpVYagvCIl\\\",\\\"previousState\\\":\\\"stateLnXuGgPLjT\\\"},\\\"stateNpVYagvCIl\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":59}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":91}],\\\"nextState\\\":\\\"stateSVjelvgorF\\\",\\\"previousState\\\":\\\"stateLDPQaqfjSp\\\"},\\\"stateSVjelvgorF\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"klulgp\\\",\\\"pinTime\\\":181,\\\"pinValue\\\":0.17367220226805172,\\\"functionString\\\":\\\"return fitSignal(\\\\\\\"Signal 1\\\\\\\", previousPinValue, nextPinValue);\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"klulgp\\\",\\\"pinTime\\\":181,\\\"pinValue\\\":0.25948670221226544,\\\"functionString\\\":\\\"return fitSignal(\\\\\\\"Signal 1\\\\\\\", previousPinValue, nextPinValue);\\\"}]}],\\\"nextState\\\":\\\"statefdDFUEzHDV\\\",\\\"previousState\\\":\\\"stateNpVYagvCIl\\\"},\\\"statefdDFUEzHDV\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":159}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":158}],\\\"nextState\\\":\\\"stateunOVQPFsHf\\\",\\\"previousState\\\":\\\"stateSVjelvgorF\\\"},\\\"stateunOVQPFsHf\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"7ttne\\\",\\\"pinTime\\\":30,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"q4new5\\\",\\\"pinTime\\\":45,\\\"pinValue\\\":0.9542050883235196,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"dp17o\\\",\\\"pinTime\\\":60,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"fi6ix4\\\",\\\"pinTime\\\":68,\\\"pinValue\\\":0.4792356404843907,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"7ajki\\\",\\\"pinTime\\\":76,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"gvacgw\\\",\\\"pinTime\\\":79,\\\"pinValue\\\":0.2716142650816577,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"clxwd\\\",\\\"pinTime\\\":82,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"3sixj\\\",\\\"pinTime\\\":85,\\\"pinValue\\\":0.13794022886345986,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"5iwibu\\\",\\\"pinTime\\\":87,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":89,\\\"pinValue\\\":0.06683701810909905,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":90,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"7ttne\\\",\\\"pinTime\\\":30,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"q4new5\\\",\\\"pinTime\\\":60,\\\"pinValue\\\":0.9542050883235196,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"dp17o\\\",\\\"pinTime\\\":90,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"fi6ix4\\\",\\\"pinTime\\\":106,\\\"pinValue\\\":0.4792356404843907,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"7ajki\\\",\\\"pinTime\\\":121,\\\"pinValue\\\":0.0014220642150873139,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"gvacgw\\\",\\\"pinTime\\\":128,\\\"pinValue\\\":0.27161426508165776,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"clxwd\\\",\\\"pinTime\\\":134,\\\"pinValue\\\":0.0014220642150873139,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"3sixj\\\",\\\"pinTime\\\":139,\\\"pinValue\\\":0.13794022886345977,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"5iwibu\\\",\\\"pinTime\\\":144,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":147,\\\"pinValue\\\":0.06683701810909909,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":150,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"nextState\\\":\\\"stateJfbgMYFlJP\\\",\\\"previousState\\\":\\\"statefdDFUEzHDV\\\"},\\\"stateJfbgMYFlJP\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"7ttne\\\",\\\"pinTime\\\":45,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"q4new5\\\",\\\"pinTime\\\":60,\\\"pinValue\\\":0.9542050883235196,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"dp17o\\\",\\\"pinTime\\\":75,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"fi6ix4\\\",\\\"pinTime\\\":83,\\\"pinValue\\\":0.4792356404843907,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"7ajki\\\",\\\"pinTime\\\":91,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"gvacgw\\\",\\\"pinTime\\\":94,\\\"pinValue\\\":0.2716142650816577,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"clxwd\\\",\\\"pinTime\\\":97,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"3sixj\\\",\\\"pinTime\\\":100,\\\"pinValue\\\":0.13794022886345986,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"5iwibu\\\",\\\"pinTime\\\":102,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":104,\\\"pinValue\\\":0.06683701810909905,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":105,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"7ttne\\\",\\\"pinTime\\\":30,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"q4new5\\\",\\\"pinTime\\\":45,\\\"pinValue\\\":0.9542050883235196,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"dp17o\\\",\\\"pinTime\\\":60,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"fi6ix4\\\",\\\"pinTime\\\":68,\\\"pinValue\\\":0.4792356404843907,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"7ajki\\\",\\\"pinTime\\\":76,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"gvacgw\\\",\\\"pinTime\\\":79,\\\"pinValue\\\":0.2716142650816577,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"clxwd\\\",\\\"pinTime\\\":82,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"3sixj\\\",\\\"pinTime\\\":85,\\\"pinValue\\\":0.13794022886345986,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"5iwibu\\\",\\\"pinTime\\\":87,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":89,\\\"pinValue\\\":0.06683701810909905,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":90,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"nextState\\\":\\\"stateEqpoqNJmSV\\\",\\\"previousState\\\":\\\"stateunOVQPFsHf\\\"},\\\"stateEqpoqNJmSV\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updateFocusRange\\\",\\\"focusRange\\\":[60,120]}],\\\"backward\\\":[{\\\"type\\\":\\\"updateFocusRange\\\",\\\"focusRange\\\":[60,180]}],\\\"nextState\\\":\\\"stateeMoZSUsoKy\\\",\\\"previousState\\\":\\\"stateJfbgMYFlJP\\\"},\\\"stateeMoZSUsoKy\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"klulgp\\\",\\\"pinTime\\\":122,\\\"pinValue\\\":0.17367220226805172,\\\"functionString\\\":\\\"return fitSignal(\\\\\\\"Signal 1\\\\\\\", previousPinValue, nextPinValue);\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"klulgp\\\",\\\"pinTime\\\":181,\\\"pinValue\\\":0.17367220226805172,\\\"functionString\\\":\\\"return fitSignal(\\\\\\\"Signal 1\\\\\\\", previousPinValue, nextPinValue);\\\"}]}],\\\"nextState\\\":\\\"stateMyyXnNuive\\\",\\\"previousState\\\":\\\"stateEqpoqNJmSV\\\"},\\\"stateMyyXnNuive\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":100}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":99}],\\\"nextState\\\":\\\"statejEINIxYtyK\\\",\\\"previousState\\\":\\\"stateeMoZSUsoKy\\\"},\\\"statejEINIxYtyK\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"7ttne\\\",\\\"pinTime\\\":45,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"q4new5\\\",\\\"pinTime\\\":64,\\\"pinValue\\\":0.9542050883235196,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"dp17o\\\",\\\"pinTime\\\":83,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"fi6ix4\\\",\\\"pinTime\\\":93,\\\"pinValue\\\":0.4792356404843907,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"7ajki\\\",\\\"pinTime\\\":103,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"gvacgw\\\",\\\"pinTime\\\":107,\\\"pinValue\\\":0.2716142650816577,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"clxwd\\\",\\\"pinTime\\\":110,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"3sixj\\\",\\\"pinTime\\\":114,\\\"pinValue\\\":0.13794022886345986,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"5iwibu\\\",\\\"pinTime\\\":117,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":119,\\\"pinValue\\\":0.06683701810909905,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":120,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"7ttne\\\",\\\"pinTime\\\":45,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"q4new5\\\",\\\"pinTime\\\":60,\\\"pinValue\\\":0.9542050883235196,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"dp17o\\\",\\\"pinTime\\\":75,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"fi6ix4\\\",\\\"pinTime\\\":83,\\\"pinValue\\\":0.4792356404843907,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"7ajki\\\",\\\"pinTime\\\":91,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"gvacgw\\\",\\\"pinTime\\\":94,\\\"pinValue\\\":0.2716142650816577,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"clxwd\\\",\\\"pinTime\\\":97,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"3sixj\\\",\\\"pinTime\\\":100,\\\"pinValue\\\":0.13794022886345986,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"5iwibu\\\",\\\"pinTime\\\":102,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":104,\\\"pinValue\\\":0.06683701810909905,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":105,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"nextState\\\":\\\"stateHbPrjovCos\\\",\\\"previousState\\\":\\\"stateMyyXnNuive\\\"},\\\"stateHbPrjovCos\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"7ttne\\\",\\\"pinTime\\\":41,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"q4new5\\\",\\\"pinTime\\\":60,\\\"pinValue\\\":0.9542050883235196,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"dp17o\\\",\\\"pinTime\\\":79,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"fi6ix4\\\",\\\"pinTime\\\":89,\\\"pinValue\\\":0.4792356404843907,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"7ajki\\\",\\\"pinTime\\\":99,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"gvacgw\\\",\\\"pinTime\\\":103,\\\"pinValue\\\":0.2716142650816577,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"clxwd\\\",\\\"pinTime\\\":106,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"3sixj\\\",\\\"pinTime\\\":110,\\\"pinValue\\\":0.13794022886345986,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"5iwibu\\\",\\\"pinTime\\\":113,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":115,\\\"pinValue\\\":0.06683701810909905,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":116,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"7ttne\\\",\\\"pinTime\\\":45,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"q4new5\\\",\\\"pinTime\\\":64,\\\"pinValue\\\":0.9542050883235196,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"dp17o\\\",\\\"pinTime\\\":83,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"fi6ix4\\\",\\\"pinTime\\\":93,\\\"pinValue\\\":0.4792356404843907,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"7ajki\\\",\\\"pinTime\\\":103,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"gvacgw\\\",\\\"pinTime\\\":107,\\\"pinValue\\\":0.2716142650816577,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"clxwd\\\",\\\"pinTime\\\":110,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"3sixj\\\",\\\"pinTime\\\":114,\\\"pinValue\\\":0.13794022886345986,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"5iwibu\\\",\\\"pinTime\\\":117,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":119,\\\"pinValue\\\":0.06683701810909905,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":120,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"nextState\\\":\\\"stateOreNZyCidW\\\",\\\"previousState\\\":\\\"statejEINIxYtyK\\\"},\\\"stateOreNZyCidW\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updateFocusRange\\\",\\\"focusRange\\\":[60,150]}],\\\"backward\\\":[{\\\"type\\\":\\\"updateFocusRange\\\",\\\"focusRange\\\":[60,120]}],\\\"nextState\\\":\\\"stateqycYgUIJNm\\\",\\\"previousState\\\":\\\"stateHbPrjovCos\\\"},\\\"stateqycYgUIJNm\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"klulgp\\\",\\\"pinTime\\\":152,\\\"pinValue\\\":0.17367220226805172,\\\"functionString\\\":\\\"return fitSignal(\\\\\\\"Signal 1\\\\\\\", previousPinValue, nextPinValue);\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"klulgp\\\",\\\"pinTime\\\":122,\\\"pinValue\\\":0.17367220226805172,\\\"functionString\\\":\\\"return fitSignal(\\\\\\\"Signal 1\\\\\\\", previousPinValue, nextPinValue);\\\"}]}],\\\"nextState\\\":\\\"stateugIGAUtUFY\\\",\\\"previousState\\\":\\\"stateOreNZyCidW\\\"},\\\"stateugIGAUtUFY\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":126}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":125}],\\\"nextState\\\":\\\"statePnhQybPLgj\\\",\\\"previousState\\\":\\\"stateqycYgUIJNm\\\"},\\\"statePnhQybPLgj\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"7ajki\\\",\\\"pinTime\\\":99,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"gvacgw\\\",\\\"pinTime\\\":106,\\\"pinValue\\\":0.2716142650816577,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"clxwd\\\",\\\"pinTime\\\":111,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"3sixj\\\",\\\"pinTime\\\":117,\\\"pinValue\\\":0.13794022886345986,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"5iwibu\\\",\\\"pinTime\\\":122,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":126,\\\"pinValue\\\":0.06683701810909905,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":127,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"7ajki\\\",\\\"pinTime\\\":99,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"gvacgw\\\",\\\"pinTime\\\":103,\\\"pinValue\\\":0.2716142650816577,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"clxwd\\\",\\\"pinTime\\\":106,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"3sixj\\\",\\\"pinTime\\\":110,\\\"pinValue\\\":0.13794022886345986,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"5iwibu\\\",\\\"pinTime\\\":113,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":115,\\\"pinValue\\\":0.06683701810909905,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":116,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"nextState\\\":\\\"stateZWOutVjsDa\\\",\\\"previousState\\\":\\\"stateugIGAUtUFY\\\"},\\\"stateZWOutVjsDa\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"clxwd\\\",\\\"pinTime\\\":111,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"3sixj\\\",\\\"pinTime\\\":116,\\\"pinValue\\\":0.13794022886345986,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"5iwibu\\\",\\\"pinTime\\\":120,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":124,\\\"pinValue\\\":0.06683701810909905,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":124,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"clxwd\\\",\\\"pinTime\\\":111,\\\"pinValue\\\":0.001422064215087254,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"3sixj\\\",\\\"pinTime\\\":117,\\\"pinValue\\\":0.13794022886345986,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"5iwibu\\\",\\\"pinTime\\\":122,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":126,\\\"pinValue\\\":0.06683701810909905,\\\"functionString\\\":\\\"return easyParabola();\\\"},{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":127,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"nextState\\\":\\\"statezHRzVADiuN\\\",\\\"previousState\\\":\\\"statePnhQybPLgj\\\"},\\\"statezHRzVADiuN\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":127,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":124,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"nextState\\\":\\\"stateOXlhenwovP\\\",\\\"previousState\\\":\\\"stateZWOutVjsDa\\\"},\\\"stateOXlhenwovP\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":123,\\\"pinValue\\\":0.06683701810909905,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"iisga\\\",\\\"pinTime\\\":124,\\\"pinValue\\\":0.06683701810909905,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"nextState\\\":\\\"statewwcvAWuVRC\\\",\\\"previousState\\\":\\\"statezHRzVADiuN\\\"},\\\"statewwcvAWuVRC\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":126,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePins\\\",\\\"pins\\\":[{\\\"pinId\\\":\\\"t5o2w\\\",\\\"pinTime\\\":127,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\"}]}],\\\"nextState\\\":\\\"statekEkmxpkVSH\\\",\\\"previousState\\\":\\\"stateOXlhenwovP\\\"},\\\"statekEkmxpkVSH\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":140}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":139}],\\\"nextState\\\":\\\"stateDFypMyXuKU\\\",\\\"previousState\\\":\\\"statewwcvAWuVRC\\\"},\\\"stateDFypMyXuKU\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":166}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":140}],\\\"nextState\\\":\\\"stateyRWvjPkQrg\\\",\\\"previousState\\\":\\\"statekEkmxpkVSH\\\"},\\\"stateyRWvjPkQrg\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"pinId\\\":\\\"g7i6p5\\\",\\\"pinTime\\\":166,\\\"pinValue\\\":0.9413903951683605,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"g7i6p5\\\"}],\\\"nextState\\\":\\\"statejfaRgzHuFq\\\",\\\"previousState\\\":\\\"stateDFypMyXuKU\\\"},\\\"statejfaRgzHuFq\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":128}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":166}],\\\"nextState\\\":\\\"statepksCZhIGSA\\\",\\\"previousState\\\":\\\"stateyRWvjPkQrg\\\"},\\\"statepksCZhIGSA\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"pinId\\\":\\\"hnccy\\\",\\\"pinTime\\\":128,\\\"pinValue\\\":0.031171867389680773,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"hnccy\\\"}],\\\"nextState\\\":\\\"stateEBWdQbyZLh\\\",\\\"previousState\\\":\\\"statejfaRgzHuFq\\\"},\\\"stateEBWdQbyZLh\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":130}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":128}],\\\"nextState\\\":\\\"statecClxYAxVXb\\\",\\\"previousState\\\":\\\"statepksCZhIGSA\\\"},\\\"statecClxYAxVXb\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"pinId\\\":\\\"5t14uv\\\",\\\"pinTime\\\":130,\\\"pinValue\\\":0,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"backward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"5t14uv\\\"}],\\\"nextState\\\":\\\"statecMmonHhwwD\\\",\\\"previousState\\\":\\\"stateEBWdQbyZLh\\\"},\\\"statecMmonHhwwD\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":63}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":130}],\\\"nextState\\\":\\\"stateVExzKTDjNv\\\",\\\"previousState\\\":\\\"statecClxYAxVXb\\\"},\\\"stateVExzKTDjNv\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":103}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":102}],\\\"nextState\\\":\\\"statemRVfNMnuza\\\",\\\"previousState\\\":\\\"statecMmonHhwwD\\\"},\\\"statemRVfNMnuza\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"deletePin\\\",\\\"pinId\\\":\\\"g7i6p5\\\"}],\\\"backward\\\":[{\\\"type\\\":\\\"addPin\\\",\\\"signalId\\\":\\\"gup3zs\\\",\\\"pinId\\\":\\\"g7i6p5\\\",\\\"pinTime\\\":166,\\\"pinValue\\\":0.9413903951683605,\\\"functionString\\\":\\\"return easyParabola();\\\",\\\"bezierControlPoints\\\":[-5,0,5,0]}],\\\"nextState\\\":\\\"statevjLrABTjOR\\\",\\\"previousState\\\":\\\"stateVExzKTDjNv\\\"},\\\"statevjLrABTjOR\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":137}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":136}],\\\"nextState\\\":\\\"stateZLlnMKeLjx\\\",\\\"previousState\\\":\\\"statemRVfNMnuza\\\"},\\\"stateZLlnMKeLjx\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":61}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":137}],\\\"nextState\\\":\\\"stateVtmyBUseYZ\\\",\\\"previousState\\\":\\\"statevjLrABTjOR\\\"},\\\"stateVtmyBUseYZ\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":135}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":134}],\\\"nextState\\\":\\\"statefEganqoFYM\\\",\\\"previousState\\\":\\\"stateZLlnMKeLjx\\\"},\\\"statefEganqoFYM\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":137}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":136}],\\\"nextState\\\":\\\"statePlvAAbNxnz\\\",\\\"previousState\\\":\\\"stateVtmyBUseYZ\\\"},\\\"statePlvAAbNxnz\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":116}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":115}],\\\"previousState\\\":\\\"statefEganqoFYM\\\",\\\"nextState\\\":\\\"stateWiPbBVWwhl\\\"},\\\"stateWiPbBVWwhl\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":90}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":116}],\\\"nextState\\\":\\\"stateyPlmnfPMXe\\\",\\\"previousState\\\":\\\"statePlvAAbNxnz\\\"},\\\"stateyPlmnfPMXe\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":121}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":120}],\\\"nextState\\\":\\\"stateLYdiYkGNZL\\\",\\\"previousState\\\":\\\"stateWiPbBVWwhl\\\"},\\\"stateLYdiYkGNZL\\\":{\\\"forward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":90}],\\\"backward\\\":[{\\\"type\\\":\\\"updatePlayheadPosition\\\",\\\"playheadPosition\\\":121}],\\\"previousState\\\":\\\"stateyPlmnfPMXe\\\"}},\\\"cursor\\\":\\\"stateLYdiYkGNZL\\\",\\\"maxSize\\\":10000}}\",\"extensionStores\":{\"applySignals\":{},\"mtrif.nativesvg\":{},\"undefined\":{},\"exportAsFrames\":{},\"mtrif.image\":{},\"mtrif.superrect\":{},\"mtrif.transform\":{\"#qcu\":{\"properties\":{\"x\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"x\",\"propertyId\":\"x\",\"signalConnected\":false,\"currentValue\":0},\"y\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"y\",\"propertyId\":\"y\",\"signalConnected\":true,\"currentValue\":0.5945718924706238,\"signalName\":\"Signal 2\"},\"anchorX\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"anchorX\",\"propertyId\":\"anchorX\",\"signalConnected\":false,\"currentValue\":0},\"anchorY\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"anchorY\",\"propertyId\":\"anchorY\",\"signalConnected\":false,\"currentValue\":0},\"rotation\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"rotation\",\"propertyId\":\"rotation\",\"signalConnected\":false,\"currentValue\":0},\"scaleX\":{\"type\":\"numeric\",\"fallbackValue\":1,\"propertyName\":\"scaleX\",\"propertyId\":\"scaleX\",\"signalConnected\":false,\"currentValue\":1},\"scaleY\":{\"type\":\"numeric\",\"fallbackValue\":1,\"propertyName\":\"scaleY\",\"propertyId\":\"scaleY\",\"signalConnected\":false,\"currentValue\":1},\"skewX\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"skewX\",\"propertyId\":\"skewX\",\"signalConnected\":false,\"currentValue\":0},\"skewY\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"skewY\",\"propertyId\":\"skewY\",\"signalConnected\":false,\"currentValue\":0}}},\"#svg\":{\"properties\":{\"x\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"x\",\"propertyId\":\"x\",\"signalConnected\":false,\"currentValue\":0},\"y\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"y\",\"propertyId\":\"y\",\"signalConnected\":false,\"currentValue\":0},\"anchorX\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"anchorX\",\"propertyId\":\"anchorX\",\"signalConnected\":false,\"currentValue\":0},\"anchorY\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"anchorY\",\"propertyId\":\"anchorY\",\"signalConnected\":false,\"currentValue\":0},\"rotation\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"rotation\",\"propertyId\":\"rotation\",\"signalConnected\":false,\"currentValue\":0},\"scaleX\":{\"type\":\"numeric\",\"fallbackValue\":1,\"propertyName\":\"scaleX\",\"propertyId\":\"scaleX\",\"signalConnected\":false,\"currentValue\":1},\"scaleY\":{\"type\":\"numeric\",\"fallbackValue\":1,\"propertyName\":\"scaleY\",\"propertyId\":\"scaleY\",\"signalConnected\":false,\"currentValue\":1},\"skewX\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"skewX\",\"propertyId\":\"skewX\",\"signalConnected\":false,\"currentValue\":0},\"skewY\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"skewY\",\"propertyId\":\"skewY\",\"signalConnected\":false,\"currentValue\":0}}},\"#s6g\":{\"properties\":{\"x\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"x\",\"propertyId\":\"x\",\"signalConnected\":false,\"currentValue\":0},\"y\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"y\",\"propertyId\":\"y\",\"signalConnected\":false,\"currentValue\":0},\"anchorX\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"anchorX\",\"propertyId\":\"anchorX\",\"signalConnected\":false,\"currentValue\":0},\"anchorY\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"anchorY\",\"propertyId\":\"anchorY\",\"signalConnected\":false,\"currentValue\":0},\"rotation\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"rotation\",\"propertyId\":\"rotation\",\"signalConnected\":false,\"currentValue\":0},\"scaleX\":{\"type\":\"numeric\",\"fallbackValue\":1,\"propertyName\":\"scaleX\",\"propertyId\":\"scaleX\",\"signalConnected\":false,\"currentValue\":1},\"scaleY\":{\"type\":\"numeric\",\"fallbackValue\":1,\"propertyName\":\"scaleY\",\"propertyId\":\"scaleY\",\"signalConnected\":false,\"currentValue\":1},\"skewX\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"skewX\",\"propertyId\":\"skewX\",\"signalConnected\":false,\"currentValue\":0},\"skewY\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"skewY\",\"propertyId\":\"skewY\",\"signalConnected\":false,\"currentValue\":0}}},\"#rr7\":{\"properties\":{\"x\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"x\",\"propertyId\":\"x\",\"signalConnected\":false,\"currentValue\":0},\"y\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"y\",\"propertyId\":\"y\",\"signalConnected\":true,\"currentValue\":0.5365128928755231,\"signalName\":\"Signal 2\"},\"anchorX\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"anchorX\",\"propertyId\":\"anchorX\",\"signalConnected\":false,\"currentValue\":0},\"anchorY\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"anchorY\",\"propertyId\":\"anchorY\",\"signalConnected\":false,\"currentValue\":0},\"rotation\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"rotation\",\"propertyId\":\"rotation\",\"signalConnected\":false,\"currentValue\":0},\"scaleX\":{\"type\":\"numeric\",\"fallbackValue\":1,\"propertyName\":\"scaleX\",\"propertyId\":\"scaleX\",\"signalConnected\":false,\"currentValue\":1},\"scaleY\":{\"type\":\"numeric\",\"fallbackValue\":1,\"propertyName\":\"scaleY\",\"propertyId\":\"scaleY\",\"signalConnected\":false,\"currentValue\":1},\"skewX\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"skewX\",\"propertyId\":\"skewX\",\"signalConnected\":false,\"currentValue\":0},\"skewY\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"skewY\",\"propertyId\":\"skewY\",\"signalConnected\":false,\"currentValue\":0}}},\"#u4s\":{\"properties\":{\"x\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"x\",\"propertyId\":\"x\",\"signalConnected\":false,\"currentValue\":0},\"y\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"y\",\"propertyId\":\"y\",\"signalConnected\":true,\"currentValue\":0.3948459411315316,\"signalName\":\"Signal 2\"},\"anchorX\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"anchorX\",\"propertyId\":\"anchorX\",\"signalConnected\":false,\"currentValue\":0},\"anchorY\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"anchorY\",\"propertyId\":\"anchorY\",\"signalConnected\":false,\"currentValue\":0},\"rotation\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"rotation\",\"propertyId\":\"rotation\",\"signalConnected\":false,\"currentValue\":0},\"scaleX\":{\"type\":\"numeric\",\"fallbackValue\":1,\"propertyName\":\"scaleX\",\"propertyId\":\"scaleX\",\"signalConnected\":false,\"currentValue\":1},\"scaleY\":{\"type\":\"numeric\",\"fallbackValue\":1,\"propertyName\":\"scaleY\",\"propertyId\":\"scaleY\",\"signalConnected\":false,\"currentValue\":1},\"skewX\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"skewX\",\"propertyId\":\"skewX\",\"signalConnected\":false,\"currentValue\":0},\"skewY\":{\"type\":\"numeric\",\"fallbackValue\":0,\"propertyName\":\"skewY\",\"propertyId\":\"skewY\",\"signalConnected\":false,\"currentValue\":0}}}},\"mtrif.polartransform\":{},\"mtrif.strokeandfill\":{\"#qcu\":{\"properties\":{\"stroke\":{\"type\":\"string\",\"fallbackValue\":\"transparent\",\"propertyName\":\"stroke\",\"propertyId\":\"stroke\",\"signalConnected\":false,\"currentValue\":\"transparent\"},\"strokeWidth\":{\"type\":\"numeric\",\"fallbackValue\":1,\"propertyName\":\"strokeWidth\",\"propertyId\":\"strokeWidth\",\"signalConnected\":false,\"currentValue\":1},\"fill\":{\"type\":\"string\",\"fallbackValue\":\"pink\",\"propertyName\":\"fill\",\"propertyId\":\"fill\",\"signalConnected\":false,\"currentValue\":\"pink\"}}},\"#rr7\":{\"properties\":{\"stroke\":{\"type\":\"string\",\"fallbackValue\":\"transparent\",\"propertyName\":\"stroke\",\"propertyId\":\"stroke\",\"signalConnected\":false,\"currentValue\":\"transparent\"},\"strokeWidth\":{\"type\":\"numeric\",\"fallbackValue\":1,\"propertyName\":\"strokeWidth\",\"propertyId\":\"strokeWidth\",\"signalConnected\":false,\"currentValue\":1},\"fill\":{\"type\":\"string\",\"fallbackValue\":\"pink\",\"propertyName\":\"fill\",\"propertyId\":\"fill\",\"signalConnected\":false,\"currentValue\":\"pink\"}}},\"#u4s\":{\"properties\":{\"stroke\":{\"type\":\"string\",\"fallbackValue\":\"transparent\",\"propertyName\":\"stroke\",\"propertyId\":\"stroke\",\"signalConnected\":false,\"currentValue\":\"transparent\"},\"strokeWidth\":{\"type\":\"numeric\",\"fallbackValue\":1,\"propertyName\":\"strokeWidth\",\"propertyId\":\"strokeWidth\",\"signalConnected\":false,\"currentValue\":1},\"fill\":{\"type\":\"string\",\"fallbackValue\":\"pink\",\"propertyName\":\"fill\",\"propertyId\":\"fill\",\"signalConnected\":false,\"currentValue\":\"pink\"}}}},\"mtrif.zigzagify\":{},\"mtrif.drawstroke\":{},\"mtrif.background\":{},\"mtrif.p5canvas\":{}}}"
    `;
    fs.writeFileSync(xmlFilePath, defaultXMLFile);
    fs.writeFileSync(jsonFilePath, defaultJSONFile, 'utf8');
    vscode.window.showInformationMessage('Project file created successfully.');
    // execute the toggle command to start the server
    vscode.commands.executeCommand('pinsandcurves.toggleServer');


  });
  context.subscriptions.push(createProjectCommand);



}
async function startWebServer(context: vscode.ExtensionContext) {
  
    // find two available ports


    let port = 3000;
    let wsPort = 3001;




  const workspaceFolders = vscode.workspace.workspaceFolders;
  if (!workspaceFolders) {
    vscode.window.showErrorMessage('No workspace folder is open.');
    return;
  }
  const workspacePath = workspaceFolders[0].uri.fsPath;



  const jsonFilePath = path.join(workspacePath, 'project.pinsandcurves.json');
  const xmlFilePath = path.join(workspacePath, 'project.pinsandcurves.xml');

  server = http.createServer((req, res) => {
    const reqUrl = req.url || '/';
    const method = req.method || 'GET';

    if (reqUrl === '/get-json' && method === 'GET') {
      // Handle /get-json endpoint
      if (!fs.existsSync(jsonFilePath)) {
        // Return 404 if the file does not exist
        res.writeHead(404, { 'Content-Type': 'application/json' });
        res.end(JSON.stringify({ error: 'File not found' }));
        return;
      }

      // Read the file and respond with its content
      const jsonData = fs.readFileSync(jsonFilePath, 'utf-8');
      res.writeHead(200, { 'Content-Type': 'application/json' });
      res.end(jsonData);

    } else if (reqUrl === '/set-json' && method === 'POST') {
      // Handle /set-json endpoint
      let body = '';
      req.on('data', chunk => {

        body += chunk.toString();
      });

      req.on('end', () => {
        try {
          const jsonData = JSON.parse(body);
          fs.writeFileSync(jsonFilePath, JSON.stringify(jsonData, null, 2));
          res.writeHead(200, { 'Content-Type': 'application/json' });
          res.end(JSON.stringify({ success: true }));
        } catch (err) {
          res.writeHead(400, { 'Content-Type': 'application/json' });
          res.end(JSON.stringify({ error: 'Invalid JSON' }));
        }
      });

    } else if (reqUrl === '/set-xml' && method === 'POST') {
      // Handle /set-json endpoint




      let body = '';
      req.on('data', chunk => {

        body += chunk.toString();
      });

      req.on('end', () => {
        try {
          watchPaused = true;
          setTimeout(() => {
            watchPaused = false;
          }, 5000);

          // get the active text editor
          const editor = vscode.window.activeTextEditor;
          const isCorrectFile = editor?.document.fileName === xmlFilePath;
          if (editor && isCorrectFile) {
            const document = editor.document;
            // replace entire document with new content
            editor.edit(editBuilder => {
              const lastLine = document.lineAt(document.lineCount - 1);
              const start = new vscode.Position(0, 0);
              const end = new vscode.Position(document.lineCount - 1, lastLine.text.length);
              const range = new vscode.Range(start, end);
              editBuilder.replace(range, body);

              // save the document in the editor
              const uri = document.uri;
              vscode.workspace.save(uri);
            });
          } else {
            fs.writeFileSync(xmlFilePath, body);
          }
          res.writeHead(200, { 'Content-Type': 'text/xml' });
          res.end(JSON.stringify({ success: true }));
        } catch (err) {
          watchPaused = false;
          res.writeHead(400, { 'Content-Type': 'text/xml' });
          res.end(JSON.stringify({ error: 'Invalid XML' }));
        }
      });

    } else if (reqUrl === '/') {
      // Serve the HTML page as before
      res.writeHead(200, { 'Content-Type': 'text/html' });
      res.end(`
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Document</title>
            <script src="https://storage.googleapis.com/pinsandcurvesservice/PinsAndCurvesServer.umd.js" crossorigin="anonymous"></script>
            <script>
            console.log('Connecting to WebSocket server...');
            const socket = new WebSocket('ws://127.0.0.1:${wsPort}');
            socket.onmessage = (event) => {
              if (event.data === 'refresh') {
                console.log('File changed, refreshing...');
                location.reload();
              }
            };
          </script>
        </head>
        <body>
        </body>
        </html>
      `);
    } else {
      // Serve other files dynamically from the workspace folder
      const filePath = path.join(workspacePath, reqUrl);
      fs.stat(filePath, (err, stats) => {
        if (err || !stats.isFile()) {
          res.writeHead(404, { 'Content-Type': 'text/plain' });
          res.end('File not found');
          return;
        }

        const ext = path.extname(filePath).toLowerCase();
        const contentType = getContentType(ext);

        res.writeHead(200, { 'Content-Type': contentType });
        fs.createReadStream(filePath).pipe(res);
      });
    }
  });

  server.listen(port, async () => {
    const serverUrl = `http://127.0.0.1:${port}/`;
    vscode.window.showInformationMessage(`Web server running at ${serverUrl}`);

    const open = await import('open');
    try {
      await open.default(serverUrl, { app: { name: 'google chrome' } });
    } catch (err: any) {
      vscode.window.showErrorMessage(`Failed to open Chrome: ${err.message}`);
    }
  });

  // Set up WebSocket server
  wss = new WebSocket.Server({ port: wsPort });
  vscode.window.showInformationMessage(`WebSocket server running at ws://127.0.0.1:${wsPort}/`);

  const filePathToWatch = workspacePath; // Watch the entire workspace folder

  // Exclude the JSON file from being watched
  const jsonFileName = path.basename(jsonFilePath);



  const watcher = chokidar.watch(filePathToWatch, {
    ignored: jsonFilePath, // Ignore the JSON file
    ignoreInitial: true,
  });

  watcher.on('change', (changedFilePath) => {
    if (watchPaused) { return; };
    console.log(`File changed: ${changedFilePath}`);
    if (path.basename(changedFilePath) === jsonFileName) {
      // Ignore changes to the JSON file
      return;
    }
    wss?.clients.forEach(client => {
      if (client.readyState === WebSocket.OPEN) {
        client.send('refresh');
      }
    });
  });




  // fs.watch(filePathToWatch, { recursive: true }, (eventType, fileName) => {
  //   console.log("watch is pause?:",watchPaused);
  //   if (watchPaused) { return; }
  //   if (!fileName) { return; };

  //   const changedFilePath = path.join(filePathToWatch, fileName);

  //   if (path.basename(changedFilePath) === jsonFileName) {
  //     // Ignore changes to the JSON file
  //     return;
  //   }

  //   // Restart the server on any other file change
  //   console.log(`File changed: ${changedFilePath}. Restarting server...`);
  //   wss?.clients.forEach(client => {
  //     if (client.readyState === WebSocket.OPEN) {
  //       client.send('refresh'); // Notify all clients to refresh
  //     }
  //   });
  // });

  // Create a status bar item
  statusBarButton = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Right, 100);
  statusBarButton.text = '$(server) Stop Pins And Curves';
  statusBarButton.command = 'pinsandcurves.toggleServer';
  statusBarButton.tooltip = 'Stop Pins And Curves';
  statusBarButton.show();
}


// Stop the web server
function stopWebServer() {
  if (server) {
    server.close(() => {
      console.log('HTTP server has been stopped.');
      server = undefined;
    });
  }
  if (wss) {
    wss.clients.forEach(client => {
      if (client.readyState === WebSocket.OPEN) {
        client.close();
      }
    });
    wss.close(() => {
      console.log('WebSocket server has been stopped.');
      wss = undefined;
    });
  }
  // Hide the status bar button
  statusBarButton.hide();
  vscode.window.showInformationMessage('Web server stopped.');
}

export function deactivate() {
  // Clean up the server and WebSocket server when the extension is deactivated
  stopWebServer();
}

// Helper function to find the first top-level file ending with pinsandcurves.xml
function findPinsAndCurvesFile(workspacePath: string): string | null {
  const files = fs.readdirSync(workspacePath, { withFileTypes: true });
  for (const file of files) {
    if (file.isFile() && file.name.endsWith('pinsandcurves.xml')) {
      return path.join(workspacePath, file.name);
    }
  }
  return null;
}


// Helper function to determine content type based on file extension
function getContentType(ext: string): string {
  switch (ext) {
    case '.html': return 'text/html';
    case '.js': return 'application/javascript';
    case '.css': return 'text/css';
    case '.png': return 'image/png';
    case '.jpg': return 'image/jpeg';
    case '.gif': return 'image/gif';
    case '.svg': return 'image/svg+xml';
    case '.json': return 'application/json';
    default: return 'application/octet-stream';
  }
}